<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="../assets/js/color-modes.js"></script>
    <script src="https://api-maps.yandex.ru/2.1/?apikey={{ yandex_api_key }}&lang=ru_RU" type="text/javascript"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <title>PLI Service</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/headers/">



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">

<link href="{{ url_for('static', filename='assets/dist/css/bootstrap.min.css') }}" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: rgba(0, 0, 0, .1);
        border: solid rgba(0, 0, 0, .15);
        border-width: 1px 0;
        box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .btn-bd-primary {
        --bd-violet-bg: #712cf9;
        --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

        --bs-btn-font-weight: 600;
        --bs-btn-color: var(--bs-white);
        --bs-btn-bg: var(--bd-violet-bg);
        --bs-btn-border-color: var(--bd-violet-bg);
        --bs-btn-hover-color: var(--bs-white);
        --bs-btn-hover-bg: #6528e0;
        --bs-btn-hover-border-color: #6528e0;
        --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
        --bs-btn-active-color: var(--bs-btn-hover-color);
        --bs-btn-active-bg: #5a23c8;
        --bs-btn-active-border-color: #5a23c8;
      }

      .bd-mode-toggle {
        z-index: 1500;
      }

      .bd-mode-toggle .dropdown-menu .active .bi {
        display: block !important;
      }

      .main-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin: 0;
        margin-left: 5%;
        margin-right: 5%;
        margin-top: 10px;
        margin-bottom: 30px;

      }
    </style>


    <!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename='headers.css') }}" rel="stylesheet">

  </head>
  <body>

    <main>

        <div class="container">
            <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">    <a href="{{ url_for('index') }}" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
                <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
                <span class="fs-4">PLI Service</span>
            </a>    <ul class="nav nav-pills">
                <li class="nav-item"><a href="{{ url_for('add_diagnostic') }}" class="nav-link active" aria-current="page">Добавить</a></li>
                <li class="nav-item"><a href="{{ url_for('view_diagnostics') }}" class="nav-link">Диагностики</a></li>
                <li class="nav-item"><a href="{{ url_for('map_page') }}" class="nav-link">Карта</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Настройки</a></li>
                <li class="nav-item"><a href="#" class="nav-link">О приложении</a></li>
                <li class="nav-item"><a href="{{ url_for('admin_panel') }}" class="nav-link">Аккаунт</a></li>
            </ul>
            </header>
        </div>
        
        <div class="main-content">
                <h2>Добавление новой диагностики</h2>
            

            <!-- Content goes here -->
            <div class="container mt-5">
                <form id="diagnosticForm" action="/submit_form" method="post">
                    <!-- Первый блок -->
                    <div class="form-section justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                        <h3>Общая информация</h3>
                        <div>
                            <label for="name" class="form-label">Название</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div>
                            <label for="type" class="form-label">Тип трубопровода</label>
                            <select class="form-select" id="type" name="type" required>
                                <option value="КК">КК</option>
                                <option value="ВК">ВК</option>
                            </select>
                        </div>
                        <div>
                            <label for="type" class="form-label">Тип диагностики</label>
                            <select class="form-select" id="diagnostic_type" name="diagnostic_type" required>
                                <option value="Приемка">Приемка</option>
                                <option value="Повреждение">Повреждение трубы</option>
                                <option value="Без повреждений">Без повреждений</option>
                                <option value="Найден колодец">Найден колодец</option>
                            </select>
                        </div>
                        <div>
                            <label for="date" class="form-label">Дата</label>
                            <input type="date" class="form-control" id="date" name="date" required>
                        </div>
                        <div>
                            <label for="diameter" class="form-label">Диаметр, мм</label>
                            <input type="number" class="form-control" id="diameter" name="diameter" required>
                        </div>
                        <div>
                            <label for="material" class="form-label">Материал</label>
                            <select class="form-select" id="material" name="material" required>
                                <option value="Корсис">Корсис</option>
                                <option value="Бетон">Бетон</option>
                                <option value="ПНД">ПНД</option>
                                <option value="Керамика">Керамика</option>
                                <option value="Сталь">Сталь</option>
                                <option value="Чугун">Чугун</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="distance" class="form-label">Расстояние, м</label>
                            <input type="number" class="form-control" id="distance" name="distance" required>
                        </div>
                    </div>

                    <!-- Карта для выбора координат -->
                    <div id="map" style="width: 60%; height: 400px"></div>
                    <!-- Скрытое поле для координат -->
                    <input type="hidden" name="coordinates" id="coordinates" required>
                    <script type="text/javascript">
                        ymaps.ready(init);
                        function init(){
                            var myMap = new ymaps.Map("map", {
                                center: [52.27,104.31],
                                zoom: 13
                            });

                            var placemark = new ymaps.Placemark(myMap.getCenter(), {}, {
                                iconLayout: 'default#image',
                                // Своё изображение иконки метки.
                                iconImageHref: '/static/assets/mark1.png',
                                // Размеры метки.
                                iconImageSize: [25, 25],
                                iconImageOffset: [-10, -10],
                                draggable: true // Позволяет перетаскивать маркер
                            });
                            myMap.geoObjects.add(placemark);

                            // Обработчик события щелчка по карте
                            myMap.events.add('click', function (e) {
                                var coords = e.get('coords');
                                // Перемещаем маркеры по щелчку в указанные координаты
                                placemark.geometry.setCoordinates(coords);
                                // Запись координат в скрытое поле
                                document.getElementById('coordinates').value = coords.join(',');
                            });
                        }
                      </script>
                    


                    <!-- Второй блок -->
                        <div class="form-section justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                            <h3>Детали пролета</h3>
                            <div id="spanSection">
                                <div class="sub-section span-group">
                                    <div>
                                        <label for="well1" class="form-label">Начальный колодец</label>
                                        <input type="number" class="form-control" name="well_0" required>
                                    </div>
                                    <div>
                                        <label for="span" class="form-label">Пролет, м</label>
                                        <input type="number" class="form-control" name="span_0" required>
                                    </div>
                                    <div>
                                        <label for="slope" class="form-label">Уклон, °</label>
                                        <input type="number" class="form-control" name="slope_0">
                                    </div>
                                    <div>
                                        <label for="flow" class="form-label">Течение</label>
                                        <select class="form-select" name="flow_0" required>
                                            <option value="против течения">⬆</option>
                                            <option value="по течению">⬇</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="well2" class="form-label">Конечный колодец</label>
                                        <input type="number" class="form-control" name="well2_0" required>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-secondary" onclick="addSpanSection()">Добавить пролет</button>
                        </div>
                    <!-- Третий блок -->
                    <div class="form-section justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                        <h3>Детали проблемы</h3>
                        <div id="problemSection">
                            <div class="sub-section problem-group">
                                <div>
                                    <label for="problem" class="form-label">Проблема</label>
                                    <textarea class="form-control" name="problem_0" rows="2" required></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="problemDistance" class="form-label">Расстояние до проблемы, м</label>
                                    <input type="number" class="form-control" name="problemDistance_0" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="addProblemSection()">Добавить проблему</button>
                    </div>
            
                    <!-- Автор -->
                    <div class="form-section">
                        <div class="mb-3">
                            <label for="author" class="form-label">Автор</label>
                            <input type="text" class="form-control" id="author" name="author" required>
                        </div>
                    </div>
            
                    <!-- Кнопка отправки -->
                    <button type="submit" class="btn btn-primary">Отправить</button>
                </form>
            </div>
            
            <!-- Скрипт, добавляющий дополнительные поля для заполнения пролетов и проблем -->
            <script>
                let spanIndex = 1; // Для отслеживания уникальности индексов пролета
                let problemIndex = 1; // Для отслеживания уникальности индексов проблем

                function addSpanSection() {
                    const spanSection = document.getElementById('spanSection');
                    const newSpan = document.createElement('div');
                    newSpan.classList.add('sub-section', 'span-group');
                    newSpan.innerHTML = `
                        <div>
                            <label for="well1" class="form-label">Начальный колодец</label>
                            <input type="number" class="form-control" name="well_${spanIndex}" required>
                        </div>
                        <div>
                            <label for="span" class="form-label">Пролет</label>
                            <input type="number" class="form-control" name="span_${spanIndex}" required>
                        </div>
                        <div>
                            <label for="slope" class="form-label">Уклон</label>
                            <input type="number" class="form-control" name="slope_${spanIndex}" required>
                        </div>
                        <div>
                            <label for="flow" class="form-label">Течение</label>
                            <select class="form-select" name="flow_${spanIndex}" required>
                                <option value="Против течения">⬆</option>
                                <option value="По течению">⬇</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="well2" class="form-label">Конечный колодец</label>
                            <input type="number" class="form-control" name="well2_${spanIndex}" required>
                        </div>
                    `;
                    spanSection.appendChild(newSpan);
                    spanIndex++;
                }
                 
                function addProblemSection() {
                    const problemSection = document.getElementById('problemSection');
                    const newProblem = document.createElement('div');
                    newProblem.classList.add('sub-section', 'problem-group');
                    newProblem.innerHTML = `
                        <div>
                            <label for="problem" class="form-label">Проблема</label>
                            <textarea class="form-control" name="problem_${problemIndex}" rows="2" required></textarea>
                        </div>
                        <div>
                            <label for="problemDistance" class="form-label">Расстояние до проблемы</label>
                            <input type="number" class="form-control" name="problemDistance_${problemIndex}" required>
                        </div class="mb-3">
                    `;
                    problemSection.appendChild(newProblem);
                    problemIndex++;
                }

                
            </script>
         </div>   
        
    </div>
</div>


      </main>
      <script src="{{ url_for('static', filename='assets/dist/js/bootstrap.bundle.min.js') }}"></script>
    </body>
</html>
